_hgtk()
{
	local cur prev opts cmds

	COMPREPLY=()
	cur="${COMP_WORDS[COMP_CWORD]}"
	prev="${COMP_WORDS[COMP_CWORD-1]}"

	cmds="about add annotate archive blame checkout clone commit datamine diff filter email forget grep guess hgignore history ignore init incoming log merge outgoing pull push recovery remove rename repoconfig revert rollback serve shelve status strip synch unshelve update userconfig vdiff verify version"

	opts="-R --repository -v --verbose -q --quiet -h --help --debugger --nofork --fork --listfile"

	if [[ ${cur} == -* ]] ; then
		COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
	else
		COMPREPLY=( $(compgen -W "${cmds}" -- ${cur}) )
	fi
	return 0
}
complete -F _hgtk hgtk
