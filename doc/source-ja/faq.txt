************
よくある質問
************

*TortoiseHg って何？*

	Mercurial 分散構成管理システムのための Windows シェル拡張です。Subversion
	における TortoiseSVN や、CVS における TortoiseCVS のような
	クライアントアプリケーションです。TortoiseHg は他のプラットフォーム向けに
	コマンドラインから起動するための hgtk スクリプトも含んでいます。

*Windows 向けの TortoiseHg インストーラには何が含まれていますか？*

	Mercurial、kdiff3、TortoisePlink、そして拡張機能として forest も同梱しています。

	`Mercurial <http://mercurial.selenic.com/wiki/>`_,
	`kdiff3 <http://kdiff3.sourceforge.net/>`_,
	`TortoisePlink <http://www.chiark.greenend.org.uk/%7Esgtatham/putty/>`_,
	そして拡張機能の hgfold 同梱しています。

*エクスプローラの右クリックメニューは英語のままなの？*

	公式 Wiki の `ダウンロード <http://bitbucket.org/kuy/thg-ja/wiki/install>`_
	ページから翻訳ファイルを入手できます。

*バージョン 0.8 でマージや任意のリビジョンへの更新はどうやるの？*

	バージョン 0.8 ではチェンジログツールからマージや更新を行うようになりました。
	チェンジログツールはエクスプローラの右クリックメニューの :guilabel:`ログの表示`
	から起動できます。

*'failed to import extension hgext.hgconfig...' という警告メッセージはどうすれば消えるの？*

	バージョン 0.7.2 以降にアップグレードしてください。ただし Windows Vista
	では若干問題があります。詳しくは
	`issue #135 <http://bitbucket.org/tortoisehg/stable/issue/135/>`_
	を参照してください。

*SSH サーバに接続できない (TortoisePlink.exe - "...cannot execute specified..." というエラーメッセージ)*

	バージョン 0.7.2 以降にはライブラリ依存のない TortoisePlink を同梱しているため、
	最新版にアップグレードすることで解決するはずです。公式 Wiki の
	`SSH 接続 <http://bitbucket.org/kuy/thg-ja/wiki/ssh>`_ ページも参考に
	してみてください。

*バージョン 0.7 以降の TortoiseHg で Qct を使うことはできますか？*

	Qct を使う前に是非 TortoiseHg 標準のコミットツールを試して欲しいところですが、
	どうしてもという方もいますので方法を載せておきます：

	1. `Qct-1.7-standalone-win32.exe <http://qct.sourceforge.net>`_ を
	   ダウンロードしてインストールします
	2. ホームディレクトリの :file:`Mercurial.ini` ファイルに以下の設定を追加します： ::

			[extensions]
			qct = C:\path\to\qct.py

			[tortoisehg]
			extcommit = qct

			[qct]
			path = "C:\Program Files\qct\qct.exe"

	これで :guilabel:`HG コミット` を実行したとき Qct が起動し、
	コマンドラインからは :command:`hg qct` が使用可能になります。
	:command:`hgtk ci` を実行しても Qct が起動します。

	バージョン 0.9 では Qct の起動ができなくなります。
	それと同時に外部コミットツールの設定も廃止されます。

*TortoiseHg で hgk (hg view) を使うことはできますか？*

	`tclkit <http://www.equi4.com/tclkit>`_ をダウンロードして
	TortoiseHg のインストールディレクトリに置きます。
	`hgk <http://www.selenic.com/repo/hg/raw-file/tip/contrib/hgk>`_
	スクリプトは Mercurial のリポジトリからダウンロードして
	:file:`TortoiseHg\\contrib` ディレクトリに置きます。
	次に :file:`hgk.cmd` ファイルを作成して :file:`TortoiseHg\\scripts`
	ディレクトリに置きます。このファイルには： ::

		@set HG=C:\Program Files\TortoiseHg\hg.exe
		@"C:\Program Files\TortoiseHg\tclkit-win32.exe" "C:\Program Files\TortoiseHg\contrib\hgk" %*

	を記述します。そして hgk を有効化するため :file:`Mercurial.ini` ファイルに： ::

		[extensions]
		hgk =

		[hgk]
		path=C:\Program Files\TortoiseHg\scripts\hgk.cmd
		vdiff=vdiff

	を設定すればコマンドラインから :command:`hg view` で起動できます。

*GUI の Diff ツールとして WinMerge を使うにはどうすればいいの？*

	ホームディレクトリの :file:`Mercurial.ini` ファイルに以下を追加してください。

		[extdiff]
		cmd.winmerge = C:\Program Files\WinMerge\WinMerge.exe
		opts.winmerge = /e /x /ub /wl

	:guilabel:`グローバル設定` ダイアログを開いて、 :guilabel:`TortoiseHg`
	タブにある :guilabel:`GUI 差分表示コマンド` のドロップダウンリストを見ると
	:guilabel:`winmerge` という項目が追加されているので、それを選択して
	:guilabel:`適用` ボタンを押してダイアログを閉じてください。

	他の WinMerge のような GUI の差分表示ツールでもこの方法で対応可能ですが、
	TortoiseHg はディレクトリ差分の機能を使うため、それをサポートしている
	ツールに限られます。バージョン 0.8 以降ではディレクトリ差分の無いツールでも
	利用可能になりました。

*GUI の Diff ツールとして Araxis Merge を使うにはどうすればいいの？*

	ホームディレクトリの :file:`Mercurial.ini` ファイルに以下を追加してください。

		[extdiff]
		cmd.adiff=C:\Program Files\Araxis\Araxis Merge v6.5\compare.exe
		opts.adiff=/wait

	:guilabel:`グローバル設定` ダイアログを開いて、 :guilabel:`TortoiseHg`
	タブにある :guilabel:`GUI 差分表示コマンド` のドロップダウンリストを見ると
	:guilabel:`adiff` という項目が追加されているので、それを選択して :guilabel:`適用`
	ボタンを押してダイアログを閉じてください。

*TortoiseHg は Windows Vista で動作しますか？*

	TortoiseHg 0.8 以降は Windows Vista / 7 の 32ビット・64ビット版共に動作します。

*64ビット版 Windows Vista で右クリックメニューを有効にするにはどうすればいいですか？*

	TortoiseHg 0.8 以降のバージョンにアップグレードしてください。

*シェル拡張を無効にする方法は？ (アイコンオーバーレイと右クリックメニュー)*

	TortoiseHg 0.8 以降を使用している場合、アイコンオーバーレイはトレイアイコンを
	クリックして表示されるメニューにある :guilabel:`オプション` から起動できる
	タスクバーダイアログで無効にできます。右クリックメニューを無効にする唯一の方法は
	TortoiseHg のインストールディレクトリにある :file:`ThgShell.dll` ファイルの
	名前を変更してエクスプローラを再起動します (シェル拡張を完全に無効化)。

	古い TortoiseHg を使っている場合はコマンドプロンプトから
	:command:`regsvr32 /u "C:\\Program Files\\TortoiseHg\\tortoisehg.dll`
	を実行してください (管理者権限が必要)。 :command:`/u` を外して実行することで
	再びシェル拡張を有効化することができます。どちらも Windows を再起動するまで
	反映されません。

*TortoiseHg はどこに設定を保存しているの？*

	TortoiseHg は2種類の設定システムを利用しています。

	1. Mercurial の設定システムで、3つのレイヤがあります
	   1. システム設定： :file:`%ProgramFiles%\\TortoiseHg` にある :file:`Mercurial.ini` ファイル
	   2. グローバル設定： :file:`%UserProfile%` にある :file:`Mercurial.ini` ファイル
	   3. リポジトリ設定： :file:`{repo-root}\.hg` にある :file:`hgrc` ファイル
	2. ダイアログの位置や状態などを保存している :file:`%APPDATA%\\Tortoisehg`

	以下は Mercurial の設定システムに保存される項目です： ::

		[tortoisehg]
		extcommit = None
		vdiff = vdiff
		editor = gvim
		tabwidth = 4
		longsummary = True
		copyhash = False
		graphlimit = 500
		authorcolor = True
		authorcolor.steve = blue

	詳細については :doc:`settings` や
	`issue #50 <http://bitbucket.org/tortoisehg/stable/issue/50/>`_
	をご覧ください。

*フォントの変更はできますか？*

	一部可能です。 TortoiseHg の各種ダイアログ (コミット、変更点の表示、
	シェルフ) のベースとなっている gtools はフォント設定が可能です： ::

		[gtools]
		# font used in changeset viewer and commit log text
		fontcomment = courier 10
		# font used for diffs in status and commit tools
		fontdiff = courier 10
		# font used in file lists in status and commit tools
		fontlist = courier 9

		# make the integrated diff window appear at the bottom or side
		# (applies to commit and status dialogs)
		diffbottom = False

*GTK のテーマを変更するにはどうすればいいの？*

	バージョン 0.7 ではインストール時に選択可能です。それ以降のバージョン
	(またはバージョン 0.7 がインストール済み) の場合は手動で変更できます：

	* :file:`C:\\Program Files\\TortoiseHg\\share\\themes` を開きます
	  (バージョン 0.8 以降は
	  :file:`C:\\Program Files\\TortoiseHg\\gtk\\share\\themes`)
	* :file:`themes` ディレクトリにあるテーマ名を覚えるか開いたままにします
	* :file:`C:\\Program Files\\TortoiseHg\\etc\\gtk-2.0` を開きます
	  (バージョン 0.8 以降は
	  :file:`C:\\Program Files\\TortoiseHg\\gtk\\etc\\gtk-2.0`)
	* :file:`gtkrc` ファイルを開いてテーマ名を変更します
	* Windows Vista の場合、ファイルを編集できないため、一度ファイルをデスクトップ
	  などにコピーしてそれを編集して保存し、元の場所に上書きコピーします
	  (表示されるセキュリティ警告のダイアログは全て「はい」を選択)
	* 変更は次に TortoiseHg を起動したときから反映されます

	同梱されていないテーマでもそれをダウンロードして :file:`share\\themes`
	ディレクトリにコピーすれば、 :file:`gtkrc` ファイルでそのテーマを設定可能です。

*アンインストールしても大量の DLL や PYD の拡張子のファイルが残ってしまう*

	再起動してください、とアンインストーラが指示しているはずです :-)
	Windows が起動している状態では削除できないファイルもあるため、それらは再起動後
	に削除されるように設定されています。

*Subversion のリポジトリを Mercurial に変換する方法は？*

	まずコマンドラインツールの svn-win32-1.6 をインストールし、そのプログラムを
	環境変数の PATH に追加してください。次に
	`convert <http://mercurial.selenic.com/wiki/ConvertExtension>`_
	拡張機能を有効化し、 :command:`hg convert` コマンドを実行することで
	変換できます。変換について何か問題が起きたときや、質問がある場合は直接
	Mercurial のメーリングリストや IRC (irc.freenode.net の #mercurial)
	に尋ねてみてください。

*Windows の TortoiseHg はどこの Python モジュールを参照しているの？*

	TortoiseHg は Python の実行に必要な環境を DLL の形で同梱しています。
	標準ライブラリは全て :file:`C:\\Program Files\\TortoiseHg` の
	:file:`library.zip` ファイルに格納されています。

	そのため、非標準の Python モジュールに依存した Mercurial 拡張機能
	を使用するとそのモジュールが見つからないため読み込みに失敗します。
	例えば ReviewBoard 拡張機能は Python の標準ライブラリに含まれていない
	simplejson モジュールをインポートします。

	そのような拡張機能を動作させるにはちょっとした変更が必要です。
	拡張機能のソースコードを開いて非標準のモジュールインポートの前に
	そのモジュールのインストール場所を追記します： ::

		import sys
		sys.path.append(r'C:\path\to\module')

	この方法はモジュールが .egg ファイルとして配布されている場合はうまくいきません。
	指定するパスは .py または .pyc ファイルを含んでいる必要があります。

*ダイアログのぎこちないフォント描画を直すにはどうすればいいの？*

	バージョン 0.8 から複数の GTK+ テーマを同梱せず、デフォルトのテーマを
	MS-Windows に変更しました。その結果、MS-Windows テーマが原因で
	フォント描画がおかしくなる場合があります。これを直すには以下の設定を
	TortoiseHg の :file:`gtkrc` ファイルに追加してください： ::

		style "msw-default"
		{
		    font_name = "MS UI Gothic 9"
		}

	:file:`gtkrc` ファイルは TortoiseHg のインストールディレクトリにあります。
	:file:`C:\\Program Files\\TortoiseHg\\gtk\\etc\\gtk-2.0\\gtkrc`

.. vim: noet ts=4
