チェンジログ
============

.. module:: changelog.dialog
	:synopsis: Dialog used to view log

チェンジログビューアは主にリビジョン履歴またはリポジトリを可視化するのに使用され、
リビジョン履歴のグラフや、親リビジョンおよび子リビジョンとの関係を表示します。
またリビジョンごとにどのファイルが変更さたのか、そしてその内容も見ることができます。
これらの機能は他のリビジョン履歴ブラウザでも提供されている機能です。

TortoiseHg のチェンジログビューアはそれ以上の機能を提供します。
チェンジログビューアはチェンジセットを選択するのに都合のよいツールなので、
チェンジセットに対する操作を含む全ての関連する作業を実行できます。

.. figure:: figures/log.png
	:alt: チェンジログ

	チェンジログビューア

ツールバーボタンを左から順に見ていきます：

	:guilabel:`再読み込み`
		リビジョン履歴を再読み込みします (別のウィンドウでコミットした時など)。
	:guilabel:`フィルタ`
		フィルタダイアログを開きます。ツールバーボタンには標準的なフィルタが
		ドロップダウンメニューとして提供されています。
	:guilabel:`検索`
		リポジトリ検索ツールを開きます。リビジョン履歴の検索やファイルの行ごとの
		情報の表示が可能です。
	:guilabel:`もう1つの親`
		マージリビジョンを表示しているときにもう1つの親リビジョンを表示できます。
	:guilabel:`同期ツール`
		同期ツールを開きます。他のリポジトリとチェンジセットのやり取りできます。


グラフパネル
----------------------


グラフ列はリポジトリのリビジョン間の親子関係を表示します。この列は読み込まれている
チェンジセットを可視化するのに必要な幅が自動的に決定されます。またチェンジログビューア
そのものの表示を崩すことのないよう、表示幅には制限が設けられています。

グラフパネルの右側にある3つのボタンを上から見ていきます：

	:guilabel:`列選択`
		グラフパネルの列の表示・非表示を切り替えます。
	:guilabel:`次の N リビジョンを表示`
		グラフパネルに次の N リビジョンを読み込みます。
	:guilabel:`全てのリビジョンを表示`
		グラフパネルに残り全てのリビジョンを読み込みます。

列表示の設定は保存されます。


リビジョンの右クリックメニュー
------------------------------

グラフパネルのリビジョンを選択して右クリックするとリビジョンの右クリックメニューが
表示されます：

	:guilabel:`GUI の差分表示ツールで表示`
		指定された GUI 差分表示ツールでこのチェンジセットを開きます。
	:guilabel:`変更点の表示`
		チェンジセットブラウザでこのチェンジセットを開きます。
	:guilabel:`ローカルとの差分を表示`
		GUI 差分表示ツールでこのチェンジセットと作業ディレクトリの内容の差分を表示します。
	:guilabel:`更新`
		作業ディレクトリをこのリビジョンにおける内容に更新します。 [#rcm1]_
	:guilabel:`マージ`
		このリビジョンとマージします。 [#rcm2]_
	:guilabel:`ハッシュ値のコピー`
		このリビジョンの完全なハッシュ値をクリップボードにコピーします。
	:guilabel:`パッチの作成`
		このリビジョンの変更点を含んだパッチを作成します
	:guilabel:`パッチをメールで送信`
		このリビジョンの変更点をメールで送信します。 [#rcm3]_
	:guilabel:`tip リビジョンのバンドル`
		選択中のリビジョンから tip リビジョンまでの全てのリビジョンを含むバンドルを作成します。
	:guilabel:`タグの追加/削除`
		TortoiseHg タグダイアログを開きます
	:guilabel:`バックアウト`
		選択中のリビジョンをバックアウトするチェンジセットを作成します
	:guilabel:`元に戻す`
		作業ディレクトリの親リビジョンを変更せずに、このリビジョンの内容に戻します。
		十分注意して使用してください。
	:guilabel:`削除`
		選択中にリビジョンとその全ての子孫にあたるリビジョンをリポジトリから削除します。 [#rcm4]_


リビジョンを選択した後、別のリビジョンの上で右クリックすると先ほどとは異なる
右クリックメニューが表示されます。このメニューにはリビジョン範囲を扱うコマンドが
含まれています。

	:guilabel:`選択中のリビジョンとの差分`
		リビジョン範囲で累積された変更をステータスビューアで開きます。
	:guilabel:`選択中のリビジョンとの GUI 差分` [#rcm5]_
		リビジョン範囲で累積された変更を GUI 差分表示ツールで開きます。
	:guilabel:`ここから選択中のリビジョンまでメールする`
		リビジョン範囲でメール送信ダイアログを開きます。
	:guilabel:`ここから選択中のリビジョンまでバンドルする`
		リビジョン範囲を含むバンドルファイルを作成します。
	:guilabel:`選択中のリビジョンとマージする` [#rcm6]_
		通常のマージは右クリックしたリビジョンと作業ディレクトリの親リビジョンとで
		行われますが、このコマンドは選択中のリビジョンを現在の親リビジョンとして
		マージします。
	 
.. [#rcm1]	選択したリビジョンが指定された状態で TortoiseHg の更新ダイアログが開きます。
.. [#rcm2]	選択したリビジョンが指定された状態で TortoiseHg のマージダイアログが開きます。
.. [#rcm3]	選択したリビジョンが指定された状態で TortoiseHg のメール送信ダイアログが開きます。
.. [#rcm4]	strip コマンドは削除したリビジョンを後で再適用できるようにバンドルファイルとして
			保存します。詳細は `こちら <http://mercurial.selenic.com/wiki/EditingHistory>`_
			を参照してください。
.. [#rcm5]	:menuselection:`グローバル設定 --> TortoiseHg --> GUI 差分表示コマンド`
.. [#rcm6]	選択中のリビジョンが現在の作業ディレクトリの親リビジョンであるときのみ有効になります。


フィルタダイアログ
----------------------------

.. figure:: figures/logfilter.jpg
	:alt: フィルタダイアログ


ファイルの右クリックメニュー
----------------------------

左下にあるファイル一覧のファイル名の上で右クリックすると、そのファイルの
右クリックメニューが表示されます：

	:guilabel:`GUI 差分表示`
		このファイルのリビジョンを GUI の差分表示ツールで開きます。 [#flcm1]_
	:guilabel:`ローカルとの差分`
		このリビジョンにおけるファイルと作業ディレクトリの該当ファイルの差分を視覚的に表示します。
	:guilabel:`ファイルに保存`
		このリビジョンにおける選択中のファイルを指定された場所に保存します。
	:guilabel:`履歴の表示`
		このファイルが変更されたリビジョンを表示します。 [#flcm2]_
	:guilabel:`行ごとの履歴を表示`
		このファイルをリポジトリ検索ツールで開き、このリビジョンの情報を表示します。
	:guilabel:`元に戻す`
		このリビジョンにおける選択中のファイルを作業ディレクトリに取り出します。 [#flcm3]_

.. [#flcm1]	:menuselection:`グローバル設定 --> TortoiseHg --> GUI エディタ`
.. [#flcm2]	ファイルの履歴を変更しない単純な変更のみ表示し、削除されたファイルなどは
				表示されません。
.. [#flcm3]	新しいファイル内容は作業ディレクトリへの変更として反映されるので、
				コミットが必要になります。


チェンジセットブラウザ
----------------------

チェンジセットブラウザは動作速度向上のため通常1つのファイルの差分のみ表示します。
一度に全てのファイルの差分を表示したい場合は :guilabel:`[全てのファイル]` を
クリックしてください。またチェンジセットブラウザは最大差分サイズを超えるファイル
は表示せず飛ばします。詳しくは
:menuselection:`グローバル設定 --> TortoiseHg --> 最大差分サイズ`

チェンジログビューアとリポジトリ検索ツールは単一のリビジョンまたはいくつかの
リビジョン範囲が連結された差分を表示するためにチェンジセットブラウザを開きます。
チェンジセットブラウザはコミットツールやシェルフツールにとても良く似ています。
左側には変更された全てのファイルが一覧表示され、右側の差分パネルには変更箇所が
行ごとに表示されます。

'変更差分モード' で開いた場合、表示しているチェンジセットからファイルまたは
ファイル内のハンクを選択して特定の変更点を抽出し、ツールバーの
:guilabel:`名前を付けて保存` ボタンからそれらをパッチとして保存できます。
これはリポジトリから必要な変更のみを取り出すのに非常に効率的な方法です。
チェンジセットブラウザはキーボードショートカットの :kbd:`Ctrl-C` に
対応しているため、ハイライトされているハンクをクリップボードにコピーできます。

残念ながら TortoiseHg はまだ変更点を取り込むためのダイアログを用意していないため、
これらについてはコマンドラインから :command:`hg import` を実行してください。


キーボードショートカット
------------------------

:kbd:`Ctrl-P`
	作業ディレクトリの親リビジョンに移動します
:kbd:`Ctrl-D`
	GUI の差分表示ツールで選択中のチェンジセットを表示します


オプション設定
--------------

チェンジログビューアには TortoiseHg 設定ダイアログのチェンジログタブから変更できる
いくつかのオプション項目があります。

	:guilabel:`コミッタの色分け`
		チェンジセットをコミッタごとに色分けします
	:guilabel:`改行を無視してログを表示`
		コミットメッセージの改行を無視して、最大80文字まで表示します
	:guilabel:`読み込むログの件数`
		一度に読み込むリビジョンの件数
	:guilabel:`ハッシュ値のコピー`
		選択時にリビジョンのチェンジセット ID (ハッシュ値) をクリップボードにコピーします

特定のコミッタに指定した色を割り当てたい場合は :file:`Mercurial.ini` ファイルに
次の設定を追加してください： ::

	[tortoisehg]
	authorcolor.コミッタ名 = color

またチェンジログビューアは TortoiseHg タブの以下の設定も反映されます：

	:guilabel:`タブ文字の幅`
		コメント情報の表示でタブ文字1つあたりいくつの空白に展開するかを指定します
	:guilabel:`最大差分サイズ`
		表示する最大の差分ファイルサイズ
	:guilabel:`差分を画面下部に表示`
		ファイル一覧の下に差分表示パネルを配置する


コマンドラインからの実行
------------------------

チェンジログビューアはコマンドラインから起動することもできます： ::

	hgtk log [OPTIONS] [FILE]

	aliases: history

	changelog viewer

	options:

	 -l --limit  limit number of changes displayed

	use "hgtk -v help log" to show global options

.. vim: noet ts=4
